{
  "name": "Intercom NPS Pipeline",
  "description": "Advanced pipeline that fetches NPS data from Intercom Series with intelligent data structure detection, calculates metrics and saves to BigQuery and Google Sheets. Features enhanced diagnostics, flexible period collection (monthly/quarterly), and robust data parsing for various Intercom export formats.",
  "parameters": [
    {
      "name": "api_key",
      "label": "Intercom API Key",
      "helpText": "API key for accessing Intercom data",
      "paramType": "TEXT",
      "isOptional": false
    },
    {
      "name": "target_table",
      "label": "BigQuery Target Table",
      "helpText": "BigQuery table for NPS data in format project:dataset.table",
      "paramType": "TEXT",
      "isOptional": false,
      "regexes": [
        "^[^:]+:[^.]+\\.[^.]+$"
      ]
    },
    {
      "name": "spreadsheet_id",
      "label": "Google Spreadsheet ID",
      "helpText": "Google Spreadsheet ID for NPS reviews",
      "paramType": "TEXT",
      "isOptional": false
    },
    {
      "name": "period_type",
      "label": "Collection Period Type",
      "helpText": "Type of collection period: 'monthly' for monthly collection or 'quarterly' for quarterly collection",
      "paramType": "TEXT",
      "isOptional": true,
      "defaultValue": "monthly",
      "regexes": [
        "^(monthly|quarterly)$"
      ]
    },
    {
      "name": "period_offset",
      "label": "Period Offset",
      "helpText": "How many periods back to collect data (1 = previous period, 2 = two periods back, etc.)",
      "paramType": "TEXT",
      "isOptional": true,
      "defaultValue": "1",
      "regexes": [
        "^[1-9]\\d*$"
      ]
    },
    {
      "name": "start_date",
      "label": "Start Date (Override)",
      "helpText": "Override start date in ISO format (YYYY-MM-DDThh:mm:ssZ). If provided, period_type and period_offset are ignored.",
      "paramType": "TEXT",
      "isOptional": true,
      "regexes": [
        "^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z$"
      ]
    },
    {
      "name": "end_date",
      "label": "End Date (Override)",
      "helpText": "Override end date in ISO format (YYYY-MM-DDThh:mm:ssZ). Must be provided together with start_date.",
      "paramType": "TEXT",
      "isOptional": true,
      "regexes": [
        "^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z$"
      ]
    },
    {
      "name": "credentials_path",
      "label": "Service Account Credentials Path",
      "helpText": "Path to service account credentials file for accessing Google Sheets. If not provided, Application Default Credentials will be used.",
      "paramType": "TEXT",
      "isOptional": true
    },
    {
      "name": "debug",
      "label": "Debug Mode",
      "helpText": "Enable debug mode to disable period filtering and process all available data with enhanced logging",
      "paramType": "TEXT",
      "isOptional": true,
      "defaultValue": "false",
      "regexes": [
        "^(true|false)$"
      ]
    },
    {
      "name": "debug_data_only",
      "label": "Data Structure Debug Mode",
      "helpText": "Run only data structure analysis without processing. Useful for understanding Intercom export format and troubleshooting data issues. Pipeline will exit after showing data structure.",
      "paramType": "TEXT",
      "isOptional": true,
      "defaultValue": "false",
      "regexes": [
        "^(true|false)$"
      ]
    }
  ]
}